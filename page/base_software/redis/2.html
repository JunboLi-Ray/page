redis多机

复制
sync
执行bgsave，发送rdb文件。
再纪录操作，发送操作。
广播操作。
psync
完整重同步，类似sync。
部分重同步，应用在断线重连。断了以后因为缓冲区纪录了主的操作，重连后根据偏移量决定完整还是部分同步，若部分则将操作发给从。

sentinel
用于主挂选从为主
本质是一个redis服务器，但功能少
建立两个异步的链接到主服务器，一个发命令，一个是订阅
主观下线，某个sentinel认为主服务已经下线
客观下线，认为主观下线的数量达到当前sentinel设置的个数
当认为主观下线,则进行交流，如果满足则客观下线，进行故障转移。

redis集群
一集群共16384个槽，全被指派才为上线
可以握手来加节点
集群只能操作0号库，根据判断命令操作key的槽，选择处理命令的节点
操作的不在此节点返回moved，重分片过程中返回ask。
重分片（重新指派槽），redis-trib软件执行指令实现
￼

<img>